# Environment Variables Setup

This document explains how to set up environment variables for the Bonfire app.

## Quick Start

1. **Copy the example file:**
   ```bash
   cp .env.example .env
   ```

2. **Fill in your values** in the `.env` file

3. **Restart Expo** to load the new environment variables:
   ```bash
   pnpm start
   ```

## Required Variables

### Supabase Configuration

Get these from your Supabase Dashboard: https://app.supabase.com/project/_/settings/api

```bash
EXPO_PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
EXPO_PUBLIC_SUPABASE_ANON_KEY=your-anon-public-key-here
```

**How to find:**
1. Go to your Supabase project dashboard
2. Navigate to Settings → API
3. Copy the **Project URL** (for `EXPO_PUBLIC_SUPABASE_URL`)
4. Copy the **anon public** key (for `EXPO_PUBLIC_SUPABASE_ANON_KEY`)

### OAuth Configuration (Optional)

Only needed if you're using Apple Sign-In and Google Sign-In:

#### Apple Sign-In

```bash
EXPO_PUBLIC_APPLE_CLIENT_ID=your-apple-service-id
```

**How to find:**
1. Go to Apple Developer Console
2. Navigate to Certificates, Identifiers & Profiles
3. Find your Service ID
4. This is typically something like `com.bonfire.app.signin`

#### Google Sign-In

```bash
EXPO_PUBLIC_GOOGLE_CLIENT_ID_IOS=your-ios-client-id.apps.googleusercontent.com
EXPO_PUBLIC_GOOGLE_CLIENT_ID_ANDROID=your-android-client-id.apps.googleusercontent.com
EXPO_PUBLIC_GOOGLE_CLIENT_ID_WEB=your-web-client-id.apps.googleusercontent.com
```

**How to find:**
1. Go to Google Cloud Console
2. Navigate to APIs & Services → Credentials
3. Create OAuth 2.0 Client IDs for each platform (iOS, Android, Web)
4. Copy the Client IDs for each platform

## Environment Variables in Expo

### How It Works

Expo automatically loads environment variables with the `EXPO_PUBLIC_` prefix and makes them available at build time via `process.env`.

### Important Notes

1. **Prefix Required:** All environment variables must start with `EXPO_PUBLIC_` to be accessible in your app
2. **No Secrets:** Never put sensitive server-side secrets in `EXPO_PUBLIC_*` variables - they're embedded in the client app
3. **Restart Required:** You must restart the Expo dev server after changing `.env` files
4. **Build Time:** Variables are embedded at build time, not runtime

### Accessing Variables in Code

```typescript
// ✅ Correct
const url = process.env.EXPO_PUBLIC_SUPABASE_URL;

// ❌ Wrong - won't work without EXPO_PUBLIC_ prefix
const url = process.env.SUPABASE_URL;
```

## Local Development

For local Supabase instance (Docker), use:

```bash
EXPO_PUBLIC_SUPABASE_URL=http://127.0.0.1:54321
EXPO_PUBLIC_SUPABASE_ANON_KEY=your-local-anon-key
```

Get the local anon key by running:
```bash
pnpm supabase:status
```

## Production/Staging Environments

### Using EAS Build

For cloud builds with EAS, set environment variables in `eas.json`:

```json
{
  "build": {
    "development": {
      "env": {
        "EXPO_PUBLIC_ENV": "development"
      }
    },
    "production": {
      "env": {
        "EXPO_PUBLIC_ENV": "production"
      }
    }
  }
}
```

Then use EAS Secrets for sensitive values:
```bash
eas secret:create --name EXPO_PUBLIC_SUPABASE_URL --value "https://..."
eas secret:create --name EXPO_PUBLIC_SUPABASE_ANON_KEY --value "..."
```

## Troubleshooting

### "Missing Supabase environment variables" error

1. Check that `.env` file exists in the `app/` directory
2. Verify variable names start with `EXPO_PUBLIC_`
3. Restart Expo dev server: `Ctrl+C` then `pnpm start`
4. Clear cache: `pnpm start --clear`

### Variables showing as undefined

1. Ensure you're using `process.env.EXPO_PUBLIC_*` (not `process.env.*`)
2. Restart Expo after adding new variables
3. Check for typos in variable names

### OAuth not working

1. Verify OAuth client IDs are correct for each platform
2. Check redirect URIs in provider dashboards match your app scheme
3. Ensure Supabase provider configuration is complete

## Security Notes

- ✅ `.env` is in `.gitignore` - your secrets stay local
- ✅ `.env.example` is committed - documents required variables
- ⚠️ `EXPO_PUBLIC_*` variables are visible in the client app
- ❌ Never commit `.env` files to git
- ❌ Never put server secrets in `EXPO_PUBLIC_*` variables
